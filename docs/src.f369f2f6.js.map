{"version":3,"sources":["lib/CanvasItem.ts","lib/utils.ts","lib/Dot.ts","lib/Path.ts","src.ts"],"names":[],"mappings":";AAMA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IANA,IAAA,EAAA,WAIA,OAJA,aAAA,GAMA,QAAA,QAAe;;ACNf,aAAA,SAAgB,IACV,IAAA,EAAM,KAAK,MAAM,SAAW,KAAK,UAI9B,MAAA,QAHC,GAAO,IAGK,MAFX,GAAO,EAAK,KAEU,MADjB,IAAN,GACkC,IAL5C,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,kBAAA,EAAA,QAAA,aAAA;;ACGa,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,WAAA,IAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,CAAA,UAAA,cAAA,OAAA,SAAA,EAAA,GAAA,EAAA,UAAA,IAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,OAAA,UAAA,eAAA,KAAA,EAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,IAAA,OAAA,SAAA,EAAA,GAAA,SAAA,IAAA,KAAA,YAAA,EAAA,EAAA,EAAA,GAAA,EAAA,UAAA,OAAA,EAAA,OAAA,OAAA,IAAA,EAAA,UAAA,EAAA,UAAA,IAAA,IAAA,GAAA,EAAA,MAAA,KAAA,iBAAA,SAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,IAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,SAAA,EAHb,IAAA,EAAA,EAAA,QAAA,iBACA,EAAA,QAAA,WAEA,EAAA,SAAA,GAQE,SAAA,EACE,EACA,EACA,EACA,EACA,GALF,IAAA,EAOE,EAAA,KAAA,OAAO,KAfE,OAgBT,EAAK,IAAM,EACX,EAAK,IAAM,CAAE,EAAC,EAAE,EAAC,GACjB,EAAK,OAAS,EACd,EAAK,MAAQ,GAAS,EAAA,eACtB,EAAK,KAAO,IAAI,OApBP,EAkDb,OAlDyB,EAAA,EAAA,GAuBvB,EAAA,UAAA,cAAA,SAAc,EAAW,GAChB,OAAA,KAAK,IAAI,cAAc,KAAK,KAAM,EAAG,IAG9C,EAAA,UAAA,QAAA,SAAQ,GACD,KAAA,KAAO,GAGd,EAAA,UAAA,KAAA,WACO,KAAA,IAAI,YACJ,KAAA,IAAI,UAAY,KAAK,OAAS,EAAA,eAE9B,KAAA,KAAK,IAAI,KAAK,IAAI,EAAG,KAAK,IAAI,EAAG,KAAK,OAAQ,EAAG,EAAI,KAAK,IAE1D,KAAA,IAAI,KAAK,KAAK,MAEd,KAAA,IAAI,SACJ,KAAA,IAAI,YAEL,KAAK,OACF,KAAA,IAAI,KAAO,aACX,KAAA,IAAI,UAAY,SAChB,KAAA,IAAI,UAAY,QAChB,KAAA,IAAI,SAAS,KAAK,KAAM,KAAK,IAAI,EAAG,KAAK,IAAI,GAC7C,KAAA,IAAI,KAAO,cAGtB,EAlDA,CAAyB,EAAA,SAAZ,QAAA,IAAA;;ACEA,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,WAAA,IAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,CAAA,UAAA,cAAA,OAAA,SAAA,EAAA,GAAA,EAAA,UAAA,IAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,OAAA,UAAA,eAAA,KAAA,EAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,IAAA,OAAA,SAAA,EAAA,GAAA,SAAA,IAAA,KAAA,YAAA,EAAA,EAAA,EAAA,GAAA,EAAA,UAAA,OAAA,EAAA,OAAA,OAAA,IAAA,EAAA,UAAA,EAAA,UAAA,IAAA,IAAA,GAAA,EAAA,MAAA,KAAA,iBAAA,SAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,IAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,UAAA,EALb,IAAA,EAAA,EAAA,QAAA,iBACA,EAAA,QAAA,WAIA,EAAA,SAAA,GAQE,SAAA,EACE,EACA,EACA,EACA,EACA,GALF,IAAA,EAOE,EAAA,KAAA,OAAO,KAfE,OAgBT,EAAK,IAAM,EACX,EAAK,OAAS,EACd,EAAK,UAAY,GAAa,EAAA,eAC9B,EAAK,YAAc,GAAe,EAAA,eAClC,EAAK,YAAc,GAAe,EAClC,EAAK,KAAO,IAAI,OArBP,EAuDb,OAvD0B,EAAA,EAAA,GAwBxB,EAAA,UAAA,cAAA,SAAc,EAAW,GAChB,OAAA,KAAK,IAAI,cAAc,KAAK,KAAM,EAAG,IAG9C,EAAA,UAAA,gBAAA,SAAgB,EAAW,GAClB,OAAA,KAAK,IAAI,gBAAgB,KAAK,KAAM,EAAG,IAGhD,EAAA,UAAA,KAAA,WACO,KAAA,KAAO,IAAI,OACV,IAAA,EAAQ,KAAK,OAAO,GAErB,KAAA,KAAK,OAAO,EAAM,GAAI,EAAM,IAC5B,IAAA,IAAI,EAAI,EAAG,EAAI,KAAK,OAAO,OAAQ,IACjC,KAAA,KAAK,OAAO,KAAK,OAAO,GAAG,GAAI,KAAK,OAAO,GAAG,IAE/C,IAAM,KAAK,OAAO,OAAS,GACxB,KAAA,KAAK,OAAO,EAAM,GAAI,EAAM,IAIhC,KAAA,IAAI,YAEJ,KAAA,IAAI,YAAc,KAAK,aAAe,EAAA,eACtC,KAAA,IAAI,UAAY,KAAK,aAAe,EACpC,KAAA,IAAI,UAAY,KAAK,WAAa,EAAA,eAElC,KAAA,IAAI,KAAK,KAAK,MACd,KAAA,IAAI,OAAO,KAAK,MAChB,KAAA,IAAI,aAEb,EAvDA,CAA0B,EAAA,SAAb,QAAA,KAAA;;ACgOT,aAAA,IAAA,EAAA,MAAA,KAAA,gBAAA,WAAA,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,UAAA,OAAA,EAAA,EAAA,IAAA,GAAA,UAAA,GAAA,OAAA,IAAA,EAAA,MAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,IAAA,IAAA,IAAA,EAAA,UAAA,GAAA,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,EAAA,IAAA,IAAA,EAAA,GAAA,EAAA,GAAA,OAAA,GAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IArOJ,IAAA,EAAA,QAAA,aACA,EAAA,QAAA,cAIA,SAAS,IACD,IAAA,EAA4B,SAAS,eAAe,KACpD,EAAqB,SAAS,eAAe,SAC7C,EAAwB,SAAS,eAAe,SAChD,EAAyB,SAAS,eAAe,UACjD,EAAuB,SAAS,eAAe,WAC/C,EAA0B,SAAS,eAAe,UAClD,EAA0B,SAAS,eAAe,OAExD,EAAS,iBAAiB,QAAS,GACnC,EAAU,iBAAiB,QAyKlB,WACP,IACM,IAAA,EAAa,KAAK,MAAM,KAAK,SAAW,GAIrC,SAAA,IACA,MAAA,CACL,KAAK,MAAM,IAAM,KAAK,UAAY,EAAI,MACtC,KAAK,MAAM,IAAM,KAAK,UAAY,EAAI,OAL1C,EAAU,IAAI,EAAA,KAAK,EAAK,GAAI,SAAU,SASjC,IAAA,IAAI,EAAI,EAAG,EAAI,EAAY,IAAK,CAC/B,IAAA,EAAQ,IAER,GAAA,EAAQ,OAAO,OAAS,EACnB,KAAA,EAAQ,cAAc,EAAM,GAAI,EAAM,KAC3C,EAAQ,IAIZ,EAAQ,OAAO,KAAK,GACpB,EAAI,UAAU,EAAG,EAAG,EAAG,GAEnB,EAAQ,OAAO,OAAS,GAC1B,EAAQ,OAIZ,EAAO,EAAO,EAAQ,OAAO,IAAI,SAAC,GAAS,OAAA,IAAI,EAAA,IAAI,EAAK,EAAK,GAAI,EAAK,GAAI,GAAI,WAC9E,EAAM,EAAO,EAAQ,QACrB,EAAQ,QAAQ,SAAC,EAAS,GACxB,EAAQ,QAAQ,OAAO,EAAG,IAC1B,EAAQ,SAEV,EAAQ,SA1MN,IAUA,EAVA,EAAM,EAAO,WAAW,MACxB,EAAK,EAAO,MAAQ,WACpB,EAAK,EAAO,OAAS,YAAc,EAAM,aAKzC,GAJK,EAAO,MACP,EAAO,OAGK,IAEjB,EAAkB,GAgIb,SAAA,EAAU,EAAY,EAAY,EAAY,GAC9C,MAAA,CAAC,EAAK,EAAI,EAAK,GAGf,SAAA,EAAS,EAAW,EAAW,EAAW,GAC3C,IAAA,EAAI,EAAU,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,IACtC,EAAI,EAAU,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,IAOxC,GALS,EAAE,GAAK,EAAE,GAAK,EAAE,GAAK,EAAE,KAEzB,KAAK,KAAK,EAAE,GAAK,EAAE,GAAK,EAAE,GAAK,EAAE,IACjC,KAAK,KAAK,EAAE,GAAK,EAAE,GAAK,EAAE,GAAK,EAAE,KAKxC,EAAO,EAGF,OAJG,EAAE,GAAK,EAAE,GAAK,EAAE,GAAK,EAAE,GAEzB,IAAG,GAAQ,GAEK,IAAjB,KAAK,KAAK,GAAc,KAAK,GAAM,EAGrC,SAAA,IACP,EAAU,GACV,EAAS,GACT,EAAU,KACV,EAAI,UAAU,EAAG,EAAG,EAAG,GAtJzB,EAAO,iBAAiB,YAAa,SAAU,GAC7C,EAAW,MAAM,IAAS,EAAE,QAAU,EAAC,KACvC,EAAW,MAAM,KAAU,EAAE,QAAU,EAAC,KAClC,IAAA,EAAS,CAAC,EAAE,QAAS,EAAE,QAAU,EAAM,cAAtC,EAAC,EAAA,GAAE,EAAC,EAAA,GAMP,GALJ,EAAI,UAAU,EAAI,GAAI,EAAI,GAAI,EAAG,GACjC,EAAI,UAAY,QAChB,EAAI,SAAS,MAAQ,EAAI,QAAU,EAAG,EAAI,GAAI,EAAI,IAClD,EAAI,YAEA,GAAW,EAAQ,MAAQ,EAAQ,OAAO,OAAS,EAAG,CAClD,IAAA,EAAmB,CAAC,EAAG,GACzB,EAAU,EACV,GAAa,EACjB,QAAQ,QAER,EAAW,UAAY,GAElB,IAAA,IAAI,EAAQ,EAAG,EAAQ,EAAQ,OAAO,OAAQ,IAAS,CACtD,IAOA,EAAQ,EAAS,EAPR,EAAQ,OAAO,GAOY,EALpC,IAAU,EAAQ,OAAO,OAAS,EAC3B,EAAQ,OAAO,GAEf,EAAQ,OAAO,EAAQ,IAG9B,EAAQ,KAAO,EAAQ,MAAK,GAAa,GAE7C,GAAW,EACX,EAAW,WAAgB,EAAQ,EAAC,KAClC,KAAK,MAAc,IAAR,GAAe,IAAG,WAI7B,GACF,EAAQ,UAAY,oBAClB,KAAK,MAAgB,IAAV,GAAmB,IAAK,KAErC,EAAQ,MAAM,MAAQ,UACb,KAAK,MAAM,KAAK,IAAI,KAAa,KAC1C,EAAQ,UAAY,gCAClB,KAAK,MAAgB,IAAV,GAAmB,IAAK,KAErC,EAAQ,MAAM,MAAQ,UAEtB,EAAQ,UAAY,uBAClB,KAAK,MAAgB,IAAV,GAAmB,IAAK,KAErC,EAAQ,MAAM,MAAQ,UAM5B,OAAO,SAAW,WAChB,EAAI,EAAO,MAAQ,WACnB,EAAI,EAAO,OAAS,YAAc,EAAM,UACnC,EAAI,EACJ,EAAI,EACT,EAAQ,QAAQ,SAAC,GACf,EAAK,SAEP,EAAQ,QAIV,EAAO,iBAAiB,QAAS,SAAU,GACnC,IAAA,EAAS,CAAC,EAAE,QAAS,EAAE,QAAU,EAAM,cAAtC,EAAC,EAAA,GAAE,EAAC,EAAA,GAIT,EAAO,OAAS,IACf,EAAQ,cAAc,EAAG,IAAM,EAAQ,gBAAgB,EAAG,MAK7D,EAAI,UAAU,EAAG,EAAG,EAAG,GAEvB,EAAO,KAAK,CAAC,EAAG,IACM,IAAlB,EAAO,OACT,EAAU,IAAI,EAAA,KAAK,EAAK,EAAQ,SAAU,SACjC,EAAO,QAAU,IAC1B,EAAQ,OAAS,EAIjB,EAAQ,QAGV,EAAQ,KAAK,IAAI,EAAA,IAAI,EAAK,EAAG,EAAG,GAAI,SACpC,EAAQ,QAAQ,SAAC,EAAM,GACrB,EAAK,QAAQ,OAAO,EAAO,IAC3B,EAAK,YAKT,EAAO,iBACL,cACA,SAAU,GACR,EAAE,iBAKG,IAJC,IAAA,EAAS,CAAC,EAAE,QAAS,EAAE,QAAU,EAAM,cACvC,EAAmB,CADjB,EAAA,GAAG,EAAA,IAEP,EAAU,EAEL,EAAQ,EAAG,EAAQ,EAAQ,OAAO,OAAQ,IAAS,CAS1D,GAAW,EAAS,EARP,EAAQ,OAAO,GAQW,EANnC,IAAU,EAAQ,OAAO,OAAS,EAC3B,EAAQ,OAAO,GAEf,EAAQ,OAAO,EAAQ,IAO7B,OAFP,QAAQ,IAAI,IAEL,IAET,GAuEO,SAAA,IACP,sBAAsB,GAExB,GAGF","file":"src.f369f2f6.js","sourceRoot":"..\\src","sourcesContent":["abstract class CanvasItem {\r\n  path: Path2D;\r\n  abstract draw(): void;\r\n  abstract isPointInPath(x, y): boolean;\r\n}\r\n\r\nexport default CanvasItem;","export function getRandomRgb() {\r\n  var num = Math.round(0xffffff * Math.random());\r\n  var r = num >> 16;\r\n  var g = (num >> 8) & 255;\r\n  var b = num & 255;\r\n  return \"rgb(\" + r + \", \" + g + \", \" + b + \")\";\r\n}\r\n","import CanvasItem from \"./CanvasItem\";\r\nimport { getRandomRgb } from \"./utils\";\r\n\r\nexport class Dot extends CanvasItem {\r\n  ctx: CanvasRenderingContext2D;\r\n  pos: { x: number; y: number };\r\n  color: string;\r\n  radius: number;\r\n  path: Path2D;\r\n  text?: string;\r\n\r\n  constructor(\r\n    ctx: CanvasRenderingContext2D,\r\n    x: number,\r\n    y: number,\r\n    radius: number,\r\n    color?: string\r\n  ) {\r\n    super();\r\n    this.ctx = ctx;\r\n    this.pos = { x, y };\r\n    this.radius = radius;\r\n    this.color = color || getRandomRgb();\r\n    this.path = new Path2D();\r\n  }\r\n\r\n  isPointInPath(x: number, y: number) {\r\n    return this.ctx.isPointInPath(this.path, x, y);\r\n  }\r\n\r\n  setText(text: string) {\r\n    this.text = text;\r\n  }\r\n\r\n  draw() {\r\n    this.ctx.beginPath();\r\n    this.ctx.fillStyle = this.color || getRandomRgb();\r\n\r\n    this.path.arc(this.pos.x, this.pos.y, this.radius, 0, 2 * Math.PI);\r\n\r\n    this.ctx.fill(this.path);\r\n\r\n    this.ctx.stroke();\r\n    this.ctx.closePath();\r\n\r\n    if (this.text) {\r\n      this.ctx.font = '12px arial'\r\n      this.ctx.textAlign = \"center\";\r\n      this.ctx.fillStyle = \"black\";\r\n      this.ctx.fillText(this.text, this.pos.x, this.pos.y);\r\n      this.ctx.font = '8px arial'\r\n    }\r\n  }\r\n}\r\n","import CanvasItem from \"./CanvasItem\";\r\nimport { getRandomRgb } from \"./utils\";\r\n\r\ntype Point = [number, number];\r\n\r\nexport class Path extends CanvasItem {\r\n  ctx: CanvasRenderingContext2D;\r\n  points: Point[];\r\n  fillColor: string;\r\n  strokeColor: string;\r\n  strokeWidth: number;\r\n  path: Path2D;\r\n\r\n  constructor(\r\n    ctx: CanvasRenderingContext2D,\r\n    points: Point[],\r\n    fillColor: string | null,\r\n    strokeColor: string | null,\r\n    strokeWidth?: number\r\n  ) {\r\n    super();\r\n    this.ctx = ctx;\r\n    this.points = points;\r\n    this.fillColor = fillColor || getRandomRgb();\r\n    this.strokeColor = strokeColor || getRandomRgb();\r\n    this.strokeWidth = strokeWidth || 1;\r\n    this.path = new Path2D();\r\n  }\r\n\r\n  isPointInPath(x: number, y: number) {\r\n    return this.ctx.isPointInPath(this.path, x, y);\r\n  }\r\n\r\n  isPointInStroke(x: number, y: number) {\r\n    return this.ctx.isPointInStroke(this.path, x, y);\r\n  }\r\n\r\n  draw() {\r\n    this.path = new Path2D();\r\n    const first = this.points[0];\r\n\r\n    this.path.moveTo(first[0], first[1]);\r\n    for (let i = 1; i < this.points.length; i++) {\r\n      this.path.lineTo(this.points[i][0], this.points[i][1]);\r\n\r\n      if (i === this.points.length - 1) {\r\n        this.path.lineTo(first[0], first[1]);\r\n      }\r\n    }\r\n\r\n    this.ctx.beginPath();\r\n\r\n    this.ctx.strokeStyle = this.strokeColor || getRandomRgb();\r\n    this.ctx.lineWidth = this.strokeWidth || 1;\r\n    this.ctx.fillStyle = this.fillColor || getRandomRgb();\r\n\r\n    this.ctx.fill(this.path);\r\n    this.ctx.stroke(this.path);\r\n    this.ctx.closePath();\r\n  }\r\n}\r\n","import { Dot } from \"./lib/Dot\";\r\nimport { Path } from \"./lib/Path\";\r\n\r\ntype Point = [number, number];\r\n\r\nfunction main() {\r\n  const canvas = <HTMLCanvasElement>document.getElementById(\"c\");\r\n  const panel = <HTMLElement>document.getElementById(\"panel\");\r\n  const resetBtn = <HTMLElement>document.getElementById(\"reset\");\r\n  const randomBtn = <HTMLElement>document.getElementById(\"random\");\r\n  const resText = <HTMLElement>document.getElementById(\"cur_pos\");\r\n  const anglesText = <HTMLElement>document.getElementById(\"angles\");\r\n  const cursor_dot = <HTMLElement>document.getElementById(\"dot\");\r\n\r\n  resetBtn.addEventListener(\"click\", reset);\r\n  randomBtn.addEventListener(\"click\", random);\r\n\r\n  /** @type {CanvasRenderingContext2D} */\r\n  let ctx = canvas.getContext(\"2d\");\r\n  let w = (canvas.width = innerWidth);\r\n  let h = (canvas.height = innerHeight - panel.offsetHeight);\r\n  let cx = canvas.width / 2;\r\n  let cy = canvas.height / 2;\r\n  const bgColor = \"rgba(17, 17, 19, 1)\";\r\n\r\n  let objects: Dot[] = [];\r\n\r\n  let points: Point[] = [];\r\n  let polygon: Path;\r\n\r\n  // Слушатель перемещения мышки (для координат в углу)\r\n  canvas.addEventListener(\"mousemove\", function (e) {\r\n    cursor_dot.style.top = `${e.clientY - 5}px`;\r\n    cursor_dot.style.left = `${e.clientX - 5}px`;\r\n    const [x, y] = [e.clientX, e.clientY - panel.offsetHeight];\r\n    ctx.clearRect(w - 80, h - 40, w, h);\r\n    ctx.textAlign = \"start\";\r\n    ctx.fillText(\"X: \" + x + \", Y: \" + y, w - 80, h - 20);\r\n    ctx.closePath();\r\n\r\n    if (polygon && polygon.path && polygon.points.length > 2) {\r\n      const cur_point: Point = [x, y];\r\n      let rad_sum = 0;\r\n      let isOnStroke = false;\r\n      console.clear();\r\n\r\n      anglesText.innerHTML = \"\";\r\n\r\n      for (let index = 0; index < polygon.points.length; index++) {\r\n        let point1 = polygon.points[index];\r\n        let point2: Point;\r\n        if (index === polygon.points.length - 1) {\r\n          point2 = polygon.points[0];\r\n        } else {\r\n          point2 = polygon.points[index + 1];\r\n        }\r\n        let angle = getAngle(cur_point, point1, cur_point, point2);\r\n        if (angle > 178 && angle < 182) isOnStroke = true;\r\n\r\n        rad_sum += angle;\r\n        anglesText.innerHTML += `${index + 1}) ${\r\n          Math.round(angle * 100) / 100\r\n        }° &nbsp;`;\r\n      }\r\n\r\n      if (isOnStroke) {\r\n        resText.innerText = `Точка на ребре (~${\r\n          Math.round(rad_sum * 10000) / 10000\r\n        }°)`;\r\n        resText.style.color = \"orange\";\r\n      } else if (Math.round(Math.abs(rad_sum)) >= 360) {\r\n        resText.innerText = `Точка принадлежит полигону (~${\r\n          Math.round(rad_sum * 10000) / 10000\r\n        }°)`;\r\n        resText.style.color = \"green\";\r\n      } else {\r\n        resText.innerText = `Точка вне полигона (${\r\n          Math.round(rad_sum * 10000) / 10000\r\n        }°)`;\r\n        resText.style.color = \"red\";\r\n      }\r\n    }\r\n  });\r\n\r\n  // Проверка ресайза окна\r\n  window.onresize = function () {\r\n    w = canvas.width = innerWidth;\r\n    h = canvas.height = innerHeight - panel.offsetTop;\r\n    cx = w / 2;\r\n    cy = h / 2;\r\n    objects.forEach((item) => {\r\n      item.draw();\r\n    });\r\n    polygon.draw();\r\n  };\r\n\r\n  // Добавление точки полигона по клику\r\n  canvas.addEventListener(\"click\", function (e) {\r\n    const [x, y] = [e.clientX, e.clientY - panel.offsetHeight];\r\n\r\n    // Запрет на прямое добавление точки внутрь полигона\r\n    if (\r\n      points.length > 2 &&\r\n      (polygon.isPointInPath(x, y) || polygon.isPointInStroke(x, y))\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    ctx.clearRect(0, 0, w, h);\r\n\r\n    points.push([x, y]);\r\n    if (points.length === 2) {\r\n      polygon = new Path(ctx, points, \"yellow\", \"black\");\r\n    } else if (points.length >= 3) {\r\n      polygon.points = points;\r\n      // polygon.points = polygon.points.filter(p => !polygon.isPointInPath(p[0], p[1]))\r\n      // console.log(polygon.points);\r\n\r\n      polygon.draw();\r\n    }\r\n\r\n    objects.push(new Dot(ctx, x, y, 10, '#ccc'));\r\n    objects.forEach((item, index) => {\r\n      item.setText(String(index +1));\r\n      item.draw();\r\n    });\r\n  });\r\n\r\n  // Правый клик и проверка принадлежности точки\r\n  canvas.addEventListener(\r\n    \"contextmenu\",\r\n    function (e) {\r\n      e.preventDefault();\r\n      const [x, y] = [e.clientX, e.clientY - panel.offsetHeight];\r\n      const cur_point: Point = [x, y];\r\n      let rad_sum = 0;\r\n\r\n      for (let index = 0; index < polygon.points.length; index++) {\r\n        let point1 = polygon.points[index];\r\n        let point2: Point;\r\n        if (index === polygon.points.length - 1) {\r\n          point2 = polygon.points[0];\r\n        } else {\r\n          point2 = polygon.points[index + 1];\r\n        }\r\n\r\n        rad_sum += getAngle(cur_point, point1, cur_point, point2);\r\n      }\r\n      console.log(rad_sum);\r\n\r\n      return false;\r\n    },\r\n    false\r\n  );\r\n\r\n  function getVector(x1: number, y1: number, x2: number, y2: number): Point {\r\n    return [x2 - x1, y2 - y1];\r\n  }\r\n\r\n  function getAngle(a1: Point, a2: Point, b1: Point, b2: Point): number {\r\n    const a = getVector(a1[0], a1[1], a2[0], a2[1]);\r\n    const b = getVector(b1[0], b1[1], b2[0], b2[1]);\r\n\r\n    let scalar = a[0] * b[0] + a[1] * b[1];\r\n\r\n    let modA = Math.sqrt(a[0] * a[0] + a[1] * a[1]);\r\n    let modB = Math.sqrt(b[0] * b[0] + b[1] * b[1]);\r\n\r\n    let cos = scalar / (modA * modB);\r\n\r\n    const opr = a[0] * b[1] - a[1] * b[0];\r\n    let znak = 1;\r\n    if (opr > 0) znak = -1;\r\n\r\n    return ((Math.acos(cos) * 180) / Math.PI) * znak;\r\n  }\r\n\r\n  function reset() {\r\n    objects = [];\r\n    points = [];\r\n    polygon = null;\r\n    ctx.clearRect(0, 0, w, h);\r\n  }\r\n\r\n  function random() {\r\n    reset();\r\n    const points_num = Math.round(Math.random() + 4);\r\n\r\n    polygon = new Path(ctx, [], \"yellow\", \"black\");\r\n\r\n    function genPoint(): Point {\r\n      return [\r\n        Math.round(100 + Math.random() * (w - 200)),\r\n        Math.round(100 + Math.random() * (h - 200)),\r\n      ];\r\n    }\r\n\r\n    for (let i = 0; i < points_num; i++) {\r\n      let point = genPoint();\r\n\r\n      if (polygon.points.length > 2) {\r\n        while (polygon.isPointInPath(point[0], point[1])) {\r\n          point = genPoint();\r\n        }\r\n      }\r\n\r\n      polygon.points.push(point);\r\n      ctx.clearRect(0, 0, w, h);\r\n\r\n      if (polygon.points.length > 2) {\r\n        polygon.draw();\r\n      }\r\n    }\r\n\r\n    objects = [...polygon.points.map((item) => new Dot(ctx, item[0], item[1], 10, '#ccc'))];\r\n    points = [...polygon.points];\r\n    objects.forEach((element, i) => {\r\n      element.setText(String(i +1));\r\n      element.draw()\r\n    });\r\n    polygon.draw();\r\n  }\r\n\r\n  function loop() {\r\n    requestAnimationFrame(loop);\r\n  }\r\n  loop();\r\n}\r\n\r\nmain();\r\n"]}